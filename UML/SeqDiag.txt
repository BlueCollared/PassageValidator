@startuml
actor Passenger
participant GateMgr
box "Ticketing Terminal (TT)"
  participant TT
  participant "Health Check Sub-Entity" as HealthCheck
end box
participant "Validation Service" as ValidationService


GateMgr -> TT : EnableDetection
activate TT

loop Hunt for QR
    Passenger --> TT : Produce QR
end

TT -> ValidationService : Validate(QR)
activate ValidationService
ValidationService --> TT : AuthorizePassage | RejectPassage \n + QR Data
deactivate ValidationService

TT --> GateMgr : AuthorizePassage | RejectPassage \n + QR Data

par Periodic Health Check    
    TT -> HealthCheck : Start Health Monitor
    loop Periodic Check
        HealthCheck -> ValidationService : CheckHealth()
        activate ValidationService
        ValidationService --> HealthCheck : Good | Bad
        deactivate ValidationService

        alt Health status changes
            HealthCheck --> TT : NotifyStatusChange(Good | Bad)
            TT --> GateMgr : NotifyStatusChange(Good | Bad)
        end
    end
end

deactivate TT
@enduml